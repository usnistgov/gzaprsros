<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>APRS Gazebo Simulation: GZAPRSROS</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">APRS Gazebo Simulation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GZAPRSROS </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<p>This gives a brief overview of how to install, build and run the gz(Gazebe) aprs (agility performane robot system) ros(robot operating system) code. It is open source with no copyright as it is government work.</p>
<h1><a class="anchor" id="Requirements"></a>Requirements</h1>
<p>Ubuntu and Platforms Tested:</p>
<p>(1) Ubuntu 16.04.6 LTS </p><pre class="fragment">&gt; lsb_release -a
No LSB modules are available.
Distributor ID: Ubuntu
Description:    Ubuntu 16.04.6 LTS
Release:    16.04
Codename:   xenial
&gt; uname -a
Linux 4.4.0-165-generic #193-Ubuntu SMP Tue Sep 17 17:42:52 UTC 2019 x86_64 x86_64 x86_64 GNU/Linux
</pre><p>And Linux installs for:</p>
<ul>
<li>Gazebo 9</li>
<li>Ros I Kinetic</li>
<li>gnu c++</li>
</ul>
<p>and if compiling with QT Qt5.9.1 (as Qt 5.5 is VERY BUGGY on Ubuntu 16.04)</p>
<p>From: <a href="https://linuxhint.com/install-qt-5-9-1-qt-creator-4-3-1-ubuntu/">https://linuxhint.com/install-qt-5-9-1-qt-creator-4-3-1-ubuntu/</a> </p><pre class="fragment">wget http://download.qt.io/official_releases/qt/5.9/5.9.1/qt-opensource-linux-x64-5.9.1.run
chmod +x qt-opensource-linux-x64-5.9.1.run
./qt-opensource-linux-x64-5.9.1.run
</pre><h1><a class="anchor" id="Gazebo_APRS_ROS_Build"></a>Gazebo APRS ROS Build</h1>
<p>Navigate to the NIST github site, and clone the gzaprsros repository: </p><pre class="fragment">&gt; git clone https://github.com/usnistgov/gzaprsros.git
</pre><p>You should see the following files and folders:</p>
<table class="doxtable">
<tr>
<td>File/Folder<br />
 </td><td>Description<br />
  </td></tr>
<tr>
<td>Install.txt&lt;BR&gt; </td><td>Brief description of installation<br />
  </td></tr>
<tr>
<td>InstallScripts<br />
 </td><td>Folder containing install scripts for gazebo, ros, etc.<br />
  </td></tr>
<tr>
<td>Readme.md&lt;BR&gt; </td><td>Readme you are reading.<br />
  </td></tr>
<tr>
<td>Worlds<br />
 </td><td>World folder containing iterations on the APRS laboratory setup<br />
  </td></tr>
<tr>
<td>bin9<br />
 </td><td>Folder containing canned bash scripts to run agility demos<br />
  </td></tr>
<tr>
<td>doc<br />
 </td><td>Folder containing documentation<br />
  </td></tr>
<tr>
<td>gzaprsros.docx&lt;BR&gt; </td><td>Word document from which <a class="el" href="Readme_8md.html">Readme.md</a> was generated<br />
  </td></tr>
<tr>
<td>gzdatabase<br />
 </td><td>Gazebo folder containing models and media definitions<br />
  </td></tr>
<tr>
<td>images<br />
 </td><td>Image folder for the readme<br />
  </td></tr>
<tr>
<td>isvalid.bash&lt;BR&gt; </td><td>Bash script to determine and/or install missing Ubuntu packages.<br />
  </td></tr>
<tr>
<td>qtbuild.bash&lt;BR&gt; </td><td>Bash script that uses Qt to build gzaprsros.<br />
  </td></tr>
<tr>
<td>rosbuild.bash&lt;BR&gt; </td><td>Bash script that uses ROS catkin_make to build gzaprsros.<br />
  </td></tr>
<tr>
<td>src<br />
 </td><td>Src folder containing ROS layout of gzaprsros packages<br />
  </td></tr>
</table>
<p>To build gzaprsros run the bash script: </p><pre class="fragment">&gt; ./rosbuild.bash
</pre><p>Note if all missing packages are automatically installed, except ROS kinetic. If you have a different version of ROS (lunar) then it won't build at this time.</p>
<p>A warning is printed at the top build that you might miss that informs you that the bash script found a duplicate Gazebo installation besides Gazebo9. THIS CAN BE A PROBLEM AND EVERYTHING WILL COMPILE BUT YOU WILL GET A SEGMENTATION FAULT IN GZSERVER.</p>
<p>FYI, there is a circular dependency of headers so one of the packages is run in isolation first, then all the packages are compile with cakint_build.</p>
<h1><a class="anchor" id="RUNNING"></a>RUNNING</h1>
<p>APRS Gazebo Execution - TWO OPTIONS mutli-terminal options: (a) (b) and (c)</p>
<p>(a) no gazebo-ros installation. Also attempts to kill any stray gazebo and ros orphan processes (gzserver, gzclient, rosmaster).</p>
<pre class="fragment">a&gt; bin9/agilitydemo.bash
</pre><p>(b) gazebo-ros packages using "ROS launch" for safety system and modbus interaction. Sets up Gazebo and DLL library lookup environment variables before invoking sequence of operations. Also attempts to kill any stray gazebo and ros orphan processes (gzserver, gzclient, rosmaster). </p><pre class="fragment">b&gt; bin9/rosagilitydemo.bash
</pre><p>(c) traditional "ROS launch" but </p><pre class="fragment">c&gt; cd src
c&gt; source devel/setup.bash
c&gt; roslaunch gzrcs gzrcs_demo.launch 
</pre><p>but you must make sure gzserver, ros, etc are not orphans and left running. No pkill in roslaunch.</p>
<p>runs gazebo as a ROS subsystem to allow rqt, etc. to communicate with Gazebo using ROS communication or services.</p>
<h1><a class="anchor" id="TESTING"></a>TESTING</h1>
<p>We will assume option (a) has been chosen, and you should see this screen:</p>
<div class="image">
<img src="./images/gzaprsros_image1.gif"  alt="Figure1"/>
</div>
<p>After running go into the aprs gz Motoman bash command line terminal and type </p><pre class="fragment">&gt; auto
</pre><p>Likewise go into theaprs gz Fanuc Fanuc bash command line terminal and type </p><pre class="fragment">&gt; auto
</pre><p>You should see both robot moving gears from trays to kits.</p>
<div class="image">
<img src="./images/gzaprsros_image2.gif"  alt="Figure2"/>
</div>
<h1><a class="anchor" id="DEBUGGING"></a>DEBUGGING</h1>
<p>You can use the QT IDE to do testing debug of the gzrcs application. To do so, first invoke: </p><pre class="fragment">a&gt; bin9/agilitylab.bash
</pre><p>which starts the rosmaster, and brings up the Gazebo with the world configures as in ./World aprs-lab.world.</p>
<p>Then, start Qt and navigate to the gzrcs.pro file in src/gzrcs. Build the system. And then "debug" the application. Depending on how the Debug command line parameter is set, either the Fanuc (-r fanuc_) or the Motoman (-r motoman_) should be the robot under control. It should read the Config.ini file, connect to the ROS master (running via the agilitylab.bash) and the Gazebo via plugins. You can set breakpoints and control the robot via the command line interface in the pop up console. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
